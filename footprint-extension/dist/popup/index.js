import{r as o,j as e,c as b,R as v}from"../assets/client-DUeHcXHK.js";function k(r){return Math.round(r/60)}const n=typeof chrome<"u"&&!!chrome.runtime,w=()=>{const[r,p]=o.useState(0),[l,c]=o.useState(!1),[f,x]=o.useState(0);o.useEffect(()=>{if(n)try{chrome.runtime.sendMessage({type:"getStatus"},s=>{s&&typeof s.paused=="boolean"&&c(s.paused)})}catch(s){console.warn("chrome.runtime not available:",s)}if(n)try{chrome.storage.local.get({events:[]},s=>{const a=s.events||[],i=new Date;i.setHours(0,0,0,0);let d=0,m=0,h=0,u=0;a.forEach(t=>{t.type==="session_end"&&t.ts>=i.getTime()&&(d+=t.duration||0),t.type==="engagement"&&t.ts>=i.getTime()&&(m+=t.data&&t.data.clicks||0,h+=t.data&&t.data.keys||0,u+=t.data&&t.data.scrolls||0)}),p(k(d)),x(Math.min(100,Math.round((m+h+u)/10)))})}catch(s){console.warn("chrome.storage not available:",s)}},[]);const g=()=>{if(!n)return c(a=>!a);const s=l?"resume":"pause";try{chrome.runtime.sendMessage({type:s},a=>{c(a?.paused||!1)})}catch(a){console.warn("togglePause failed:",a)}},y=()=>{if(!n){window.open("options/index.html","_blank");return}try{chrome.runtime.openOptionsPage?chrome.runtime.openOptionsPage(()=>{chrome.runtime.lastError&&window.open(chrome.runtime.getURL("options/index.html"),"_blank")}):window.open(chrome.runtime.getURL("options/index.html"),"_blank")}catch(s){console.warn("openOptions failed, falling back:",s);try{window.open(chrome.runtime.getURL("options/index.html"),"_blank")}catch{}}},j=()=>{if(!n){window.open("https://example.com/your-dashboard","_blank");return}try{chrome.tabs.create({url:"https://example.com/your-dashboard"})}catch(s){console.warn("openDashboard failed:",s)}};return e.jsxs("div",{className:"popup",children:[e.jsxs("header",{className:"pf-header",children:[e.jsx("div",{className:"logo",children:"ðŸ¦¶"}),e.jsx("h1",{children:"Digital Footprint"})]}),e.jsxs("div",{className:"cards",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"title",children:"Today"}),e.jsxs("div",{className:"value",children:[r," min"]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"title",children:"Engagement"}),e.jsxs("div",{className:"value",children:[f," / 100"]})]})]}),e.jsxs("div",{className:"controls",children:[e.jsx("button",{className:"primary",onClick:g,children:l?"Resume Tracking":"Pause Tracking"}),e.jsxs("div",{className:"secondary-row",children:[e.jsx("button",{className:"link",onClick:y,children:"Options"}),e.jsx("button",{className:"link",onClick:j,children:"Dashboard"})]})]}),e.jsx("footer",{className:"pf-footer",children:e.jsx("small",{children:"Data stored locally. Text scanning off by default."})})]})};b.createRoot(document.getElementById("root")).render(e.jsx(v.StrictMode,{children:e.jsx(w,{})}));
