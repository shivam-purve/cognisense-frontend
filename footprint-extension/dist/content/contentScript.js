(function(){let t={clicks:0,keys:0,scrolls:0};function s(e){if(!e)return!1;const n=(e.tagName||"").toLowerCase(),r=(e.type||"").toLowerCase(),o=(e.autocomplete||"").toLowerCase();return!!(n==="input"&&["password","email","tel","number"].includes(r)||o.includes("cc-"))}function c(e,n){try{chrome.runtime.sendMessage(e,r=>{if(chrome.runtime.lastError){n?.({ok:!1});return}n?.(r)})}catch{n?.({ok:!1})}}document.addEventListener("click",e=>{s(e.target)||t.clicks++},{passive:!0}),document.addEventListener("keydown",e=>{const n=document.activeElement;!s(n)&&e.key?.length===1&&t.keys++},{passive:!0});let a=0;window.addEventListener("scroll",()=>{const e=Date.now();e-a>300&&(t.scrolls++,a=e)},{passive:!0}),setInterval(()=>{!t.clicks&&!t.keys&&!t.scrolls||c({type:"engagement",data:t},()=>{t={clicks:0,keys:0,scrolls:0}})},1e4);function i(){try{return document.body?.innerText?.slice(0,5e4)||""}catch{return""}}c({type:"page_html",text:i()}),chrome.runtime.onMessage.addListener((e,n,r)=>{if(e?.type&&e.type==="request_full_text")return r({text:i()}),!0})})();
